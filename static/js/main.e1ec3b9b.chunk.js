(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{14:function(t,e,n){},15:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var a=n(2),r=n.n(a),i=n(9),c=n.n(i),s=(n(14),n(6)),u=(n(15),n(5)),o=n(3),d=n(1),l=n.n(d),p=n(4),b=n.p+"static/media/delete_basket.1edb1a32.svg",m=n.p+"static/media/people.0c1eddfc.svg",f=n(0),j=function(t){var e=Object(a.useState)(!1),n=Object(s.a)(e,2),r=n[0],i=n[1],c=function(){i(!1)};return Object(f.jsxs)("div",{className:"box "+t.title.toLowerCase(),children:[t.fields?Object(f.jsxs)("div",{className:"box_add-modal"+(r?" open":""),children:[t.fields.map((function(t,e){return"select"===t.type?Object(f.jsx)("select",{name:t.name,children:t.options?t.options.map((function(t,e){return Object(f.jsx)("option",{value:t.value,children:t.text},e)})):""},e):Object(f.jsx)("input",{type:t.type,name:t.name,placeholder:t.placeholder},e)})),Object(f.jsx)("button",{onClick:function(e){var n,a={},r=e.target.parentNode.querySelectorAll("input"),i=Object(u.a)(r);try{for(i.s();!(n=i.n()).done;){var s=n.value;a[s.name]=s.value,s.value=""}}catch(b){i.e(b)}finally{i.f()}var o,d=e.target.parentNode.querySelectorAll("select"),l=Object(u.a)(d);try{for(l.s();!(o=l.n()).done;){var p=o.value;a[p.name]=p.selectedOptions[0].value}}catch(b){l.e(b)}finally{l.f()}t.okClickHandler&&a&&t.okClickHandler(a),c()},children:"OK"})]}):"",Object(f.jsxs)("div",{className:"box-header",children:[Object(f.jsx)("h2",{children:t.title}),t.buttonShouldBe?Object(f.jsx)("button",{onClick:function(){i(!0)},children:"+Add"}):""]}),t.buttonShouldBe?Object(f.jsx)("div",{className:"shadow-bg"+(r?" open":""),onClick:c}):"",t.children]})},x=r.a.createContext({}),h=function(){var t,e=Object(a.useContext)(x),n=function(){var t=Object(p.a)(l.a.mark((function t(n){var a,r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.library.data.items.length?e.library.data.items.reduce((function(t,e){return e.id>t.id?e:t})).id:0,r=e.library,i=e.library.data.participants.map((function(t){return t.id})),r.data.items.push({id:a+1,name:n.title,sum:+(+n.sum).toFixed(2),participantsId:i}),t.next=6,e.updateLibrary(Object(o.a)({},r));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r=function(){var t=Object(p.a)(l.a.mark((function t(n){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=e.library).data.items=e.library.data.items.filter((function(t){return t.id!==n})),t.next=4,e.updateLibrary(Object(o.a)({},a));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i=function(){var t=Object(p.a)(l.a.mark((function t(n,a){var r,i,c,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.library,(i=r.data.items.find((function(t){return t.id===n})))&&(c=r.data.items.indexOf(i),i.participantsId.includes(a)?(s=i.participantsId.indexOf(a),r.data.items[c].participantsId.splice(s,1)):r.data.items[c].participantsId.push(a)),t.next=5,e.updateLibrary(Object(o.a)({},r));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),c=[],s=Object(u.a)(e.library.data.participants);try{for(s.s();!(t=s.n()).done;){var d=t.value;c[d.id]=d.name}}catch(O){s.e(O)}finally{s.f()}var h=e.library.data.items.length?e.library.data.items.reduce((function(t,e){return Object(o.a)(Object(o.a)({},e),{},{sum:+e.sum+ +t.sum})})).sum:0;return Object(f.jsxs)(j,{title:"Items",buttonShouldBe:!0,fields:[{type:"text",name:"title",placeholder:"Item Title"},{type:"number",name:"sum",placeholder:"Enter Sum"}],okClickHandler:n,children:[e.library.data.items.map((function(t){return Object(f.jsxs)("div",{className:"box_item-box",children:[Object(f.jsxs)("p",{children:[t.name," ---- ",t.sum]}),Object(f.jsx)("img",{src:m,alt:"people button",className:"item-box_button item-box_button_people"}),Object(f.jsx)("ul",{className:"item-box_participants-list",children:c.map((function(e,n){return Object(f.jsx)("li",{children:Object(f.jsxs)("label",{children:[Object(f.jsx)("input",{type:"checkbox",checked:t.participantsId.includes(n),onChange:function(){return i(t.id,n)}}),Object(f.jsx)("span",{children:e})]})})}))}),Object(f.jsx)("img",{src:b,onClick:function(){return r(t.id)},alt:"delete button",className:"item-box_button item-box_button_delete"})]},t.id)})),Object(f.jsxs)("p",{children:["Total: ",h]})]})},O=function(){var t=Object(a.useContext)(x),e=function(){var e=Object(p.a)(l.a.mark((function e(n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.library).data.participants=t.library.data.participants.filter((function(t){return t.id!==n})),a.data.spending=t.library.data.spending.filter((function(t){return t.participantId!==n})),e.next=5,t.updateLibrary(Object(o.a)({},a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=Object(p.a)(l.a.mark((function e(n){var a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.library.data.participants.length?t.library.data.participants.reduce((function(t,e){return e.id>t.id?e:t})).id:0,r=t.library,i={id:a+1,name:n.name},r.data.participants.push(i),e.next=6,t.updateLibrary(Object(o.a)({},r));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)(j,{title:"Participants",buttonShouldBe:!0,fields:[{type:"text",name:"name",placeholder:"Enter participant name"}],okClickHandler:n,children:[t.library.data.participants.map((function(t){return Object(f.jsxs)("div",{className:"box_item-box",children:[Object(f.jsx)("p",{children:t.name}),Object(f.jsx)("img",{onClick:function(){return e(t.id)},src:b,alt:"delete button",className:"item-box_button item-box_button_delete"})]},t.id)})),Object(f.jsxs)("p",{children:["Total: ",t.library.data.participants.length]})]})},v=function(t){var e,n=Object(a.useContext)(x),r=function(){var e=Object(p.a)(l.a.mark((function e(a){var r,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.library,(i=r.results.find((function(t){return t.id===a})))&&(c=r.results.indexOf(i),r.results[c].approved=!r.results[c].approved),e.next=5,n.updateLibrary(Object(o.a)({},r));case 5:t.showResults();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=[],c=Object(u.a)(n.library.results);try{var s=function(){var t=e.value,a=n.library.data.participants.find((function(e){return e.id===t.fromId})),r=a?a.name:"Unknown",c=(a=n.library.data.participants.find((function(e){return e.id===t.toId})))?a.name:"Unknown";i.push({id:t.id,from:r,to:c,sum:t.sum,approved:t.approved})};for(c.s();!(e=c.n()).done;)s()}catch(d){c.e(d)}finally{c.f()}return Object(f.jsx)(j,{title:"Results",buttonShouldBe:!1,children:i.map((function(t,e){return Object(f.jsxs)("div",{className:t.approved?"box_item-box box_item-box_approved":"box_item-box",children:[Object(f.jsxs)("p",{children:["From ",t.from," to ",t.to," - ",t.sum]}),Object(f.jsx)("button",{onClick:function(){return r(t.id)},className:"item-box_button item-box_button_approve"})]},e)}))})},y=function(){var t=Object(a.useContext)(x),e=[{type:"select",name:"participant",options:t.library.data.participants.map((function(t){return{value:t.id,text:t.name}}))},{type:"number",name:"sum",placeholder:"Enter Sum"}],n=function(){var e=Object(p.a)(l.a.mark((function e(n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.library.data.spending.length?t.library.data.spending.reduce((function(t,e){return e.id>t.id?e:t})).id:0,(r=t.library).data.spending.push({id:a+1,participantId:+n.participant,amount:+(+n.sum).toFixed(2)}),e.next=5,t.updateLibrary(Object(o.a)({},r));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Object(p.a)(l.a.mark((function e(n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.library).data.spending=t.library.data.spending.filter((function(t){return t.id!==n})),e.next=4,t.updateLibrary(Object(o.a)({},a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=t.library.data.spending.map((function(e){var n=t.library.data.participants.find((function(t){return t.id===e.participantId})),a=n&&n.name?n.name:"Unknown";return{id:e.id,participantName:a,amount:e.amount}})),c=t.library.data.spending.length?t.library.data.spending.reduce((function(t,e){return Object(o.a)(Object(o.a)({},e),{},{amount:+e.amount+ +t.amount})})).amount:0;return Object(f.jsxs)(j,{title:"Spending",buttonShouldBe:!0,fields:e,okClickHandler:n,children:[i.map((function(t){return Object(f.jsxs)("div",{className:"box_item-box",children:[Object(f.jsxs)("p",{children:[t.participantName,": ",t.amount]}),Object(f.jsx)("img",{onClick:function(){return r(t.id)},src:b,alt:"delete button",className:"item-box_button item-box_button_delete"})]},t.id)})),Object(f.jsxs)("p",{children:["Total: ",c]})]})},g=function(){var t=Object(a.useState)(JSON.parse(localStorage.getItem("library")||"")),e=Object(s.a)(t,2),n=e[0],r=e[1],i=Object(a.useState)(!1),c=Object(s.a)(i,2),d=c[0],b=c[1],m=(Object(a.useContext)(x),function(){var t=Object(p.a)(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r(e),b(!1),t.next=4,localStorage.setItem("library",JSON.stringify(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),j=function(){var t=Object(p.a)(l.a.mark((function t(){var e,a,r,i,c,s,d,p,f,j,x,h,O;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.data.spending.length?n.data.spending.reduce((function(t,e){return Object(o.a)(Object(o.a)({},e),{},{amount:+e.amount+ +t.amount})})).amount:0,a=n.data.items.length?n.data.items.reduce((function(t,e){return Object(o.a)(Object(o.a)({},e),{},{sum:+e.sum+ +t.sum})})).sum:0,console.log(e),console.log(a),e===a){t.next=7;break}return console.log("non equal"),t.abrupt("return");case 7:r=[],i=[],n.data.participants.forEach((function(t){var e,a=0,c=Object(u.a)(n.data.spending);try{for(c.s();!(e=c.n()).done;){var s=e.value;s.participantId===t.id&&(a+=s.amount)}}catch(m){c.e(m)}finally{c.f()}var o,d=0,l=Object(u.a)(n.data.items);try{for(l.s();!(o=l.n()).done;){var p=o.value;p.participantsId.length&&p.participantsId.includes(t.id)&&(d+=+(p.sum/p.participantsId.length).toFixed(2))}}catch(m){l.e(m)}finally{l.f()}var b=d>a;b?r.push({id:t.id,name:t.name,debtor:b,balance:d-a}):i.push({id:t.id,name:t.name,debtor:b,balance:a-d})})),(c=n).results=[],s=0,d=i;case 13:if(!(s<d.length)){t.next=40;break}p=d[s],f=Object(u.a)(r),t.prev=16,f.s();case 18:if((j=f.n()).done){t.next=29;break}if(x=j.value,!(p.balance<=0)){t.next=22;break}return t.abrupt("break",29);case 22:if(!(x.balance<=0)){t.next=24;break}return t.abrupt("continue",27);case 24:h=0,p.balance>=x.balance?(h=x.balance,p.balance-=h):(h=p.balance,x.balance-=h),h>0&&(O=c.results.length?c.results.reduce((function(t,e){return e.id>t.id?e:t})).id:0,c.results.push({id:O+1,fromId:x.id,toId:p.id,sum:h.toFixed(2),approved:!1}));case 27:t.next=18;break;case 29:t.next=34;break;case 31:t.prev=31,t.t0=t.catch(16),f.e(t.t0);case 34:return t.prev=34,f.f(),t.finish(34);case 37:s++,t.next=13;break;case 40:return t.next=42,m(Object(o.a)({},c));case 42:b(!0);case 43:case"end":return t.stop()}}),t,null,[[16,31,34,37]])})));return function(){return t.apply(this,arguments)}}();return Object(f.jsx)("div",{children:Object(f.jsxs)(x.Provider,{value:{updateLibrary:m,library:n},children:[Object(f.jsxs)("div",{children:[Object(f.jsx)(O,{}),Object(f.jsx)(y,{}),Object(f.jsx)(h,{}),d?Object(f.jsx)(v,{showResults:function(){return b(!0)}}):null]}),Object(f.jsx)("button",{onClick:j,children:"Calculate"})]})})},k={owner:"",date:"",name:"",id:1,data:{participants:[],spending:[],items:[]},results:[{id:1,fromId:1,toId:2,sum:1200,approved:!1}]};var w=function(){var t=Object(a.useState)(!1),e=Object(s.a)(t,2),n=e[0];return e[1],localStorage.getItem("library")||(localStorage.setItem("library",JSON.stringify(k)),console.log("put")),Object(f.jsxs)("div",{className:"app",children:[Object(f.jsx)("header",{className:"app-header",children:Object(f.jsx)("h1",{className:"app-name",children:"BillShare"})}),Object(f.jsx)("main",{className:"app-content"+(n?" menu_open":""),children:Object(f.jsx)(g,{})})]})},I=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,19)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),a(t),r(t),i(t),c(t)}))};c.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(w,{})}),document.getElementById("root")),I()}},[[18,1,2]]]);
//# sourceMappingURL=main.e1ec3b9b.chunk.js.map